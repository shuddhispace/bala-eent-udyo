<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Owner Dashboard ‚Ä¢ Shri Bala Eent Udyog</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

<style>
:root{
  --primary:#b53030;
  --dark:#8e1f1f;
  --bg:#f4f6fa;
  --card:#ffffff;
  --text:#333;
  --muted:#777;
}

*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:Poppins,sans-serif;
}

body{
  background:var(--bg);
  color:var(--text);
}

/* ===== HEADER ===== */
header{
  background:linear-gradient(135deg,var(--primary),var(--dark));
  color:#fff;
  padding:16px 20px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

header h2{
  font-size:20px;
  font-weight:700;
}

.logout{
  background:#fff;
  color:var(--primary);
  border:none;
  padding:8px 14px;
  border-radius:10px;
  font-weight:600;
  cursor:pointer;
}

/* ===== CONTAINER ===== */
.container{
  max-width:1200px;
  margin:20px auto;
  padding:0 16px;
}

/* ===== SUMMARY CARDS ===== */
.cards{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:14px;
}

.card{
  background:var(--card);
  padding:18px;
  border-radius:18px;
  box-shadow:0 10px 25px rgba(0,0,0,.08);
}

.card small{
  color:var(--muted);
  font-size:13px;
}

.card h3{
  margin-top:6px;
  color:var(--primary);
  font-size:22px;
}

/* ===== SECTION ===== */
.section{
  background:var(--card);
  margin-top:22px;
  padding:20px;
  border-radius:18px;
  box-shadow:0 10px 25px rgba(0,0,0,.08);
}

.section h3{
  color:var(--primary);
  margin-bottom:14px;
  font-size:18px;
}

/* ===== ACTION BUTTONS ===== */
.actions{
  display:flex;
  gap:12px;
  flex-wrap:wrap;
}

.actions button{
  background:linear-gradient(135deg,var(--primary),var(--dark));
  color:#fff;
  border:none;
  padding:12px 18px;
  border-radius:12px;
  font-weight:600;
  cursor:pointer;
}

/* ===== RESPONSIVE ===== */
@media(max-width:600px){
  header h2{font-size:18px}
}
</style>
</head>

<body>

<!-- ================= AUTH CHECK ================= -->
<script>
/* üîê OWNER AUTH CHECK */
if(localStorage.getItem("OWNER_AUTH") !== "YES"){
  window.location.replace("owner-login.html");
}

function logout(){
  localStorage.removeItem("OWNER_AUTH");
  window.location.replace("owner-login.html");
}
</script>

<header>
  <h2>Owner Dashboard</h2>
  <button class="logout" onclick="logout()">Logout</button>
</header>
<!-- ===== ADVANCE MODAL ===== -->
<div id="advanceModal" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,.6);align-items:center;justify-content:center;z-index:1000">
  <div style="background:#fff;width:100%;max-width:420px;border-radius:18px;padding:22px;box-shadow:0 20px 50px rgba(0,0,0,.3)">
    
    <h3 style="color:#b53030;margin-bottom:12px">Give Advance</h3>

    <input id="advWorker" placeholder="Worker Name" style="width:100%;padding:12px;margin-bottom:10px;border-radius:10px;border:1px solid #ccc">

    <select id="advType" style="width:100%;padding:12px;margin-bottom:10px;border-radius:10px">
      <option value="">Select Type</option>
      <option value="Pathira">Pathira</option>
      <option value="Nikasi">Nikasi</option>
    </select>

    <input id="advAmount" type="number" placeholder="Amount (‚Çπ)" style="width:100%;padding:12px;margin-bottom:10px;border-radius:10px;border:1px solid #ccc">

    <input id="advUnit" placeholder="Production Unit (Unit-1)" style="width:100%;padding:12px;margin-bottom:14px;border-radius:10px;border:1px solid #ccc">

    <div style="display:flex;gap:10px;justify-content:flex-end">
      <button onclick="closeAdvance()" style="padding:10px 14px;border-radius:10px;border:1px solid #999;background:#fff">Cancel</button>
      <button onclick="saveAdvance()" style="padding:10px 16px;border-radius:10px;border:none;background:#b53030;color:#fff">Save</button>
    </div>

  </div>
</div>

  <!-- ===== ACTIONS ===== -->
  <div class="section">
    <h3>Calculation & Data Entry</h3>
    <div class="actions">
      <button onclick="openAdvance()">‚ûï Give Advance</button>
      <button onclick="openMaterial()">‚ûï Add Material</button>
      <button onclick="openProduction()">‚ûï Add Production</button>
    </div>
  </div>

</div>

<!-- ================= SCRIPT ================= -->
<script>
const API_URL = "https://script.google.com/macros/s/AKfycbz7g1uBjsdCOj_gZ0Pux_REch0j--yd5tPUe4txiDrD2dGY2pGxEn_kitWyQo7pplkpqg/exec";

/* ===== OPEN / CLOSE MODAL ===== */
function openAdvance(){
  document.getElementById("advanceModal").style.display="flex";
}
function closeAdvance(){
  document.getElementById("advanceModal").style.display="none";
}

/* ===== SAVE ADVANCE ===== */
function saveAdvance(){
  const worker = advWorker.value.trim();
  const type   = advType.value;
  const amount = advAmount.value;
  const unit   = advUnit.value || "Unit-1";

  if(!worker || !type || !amount){
    alert("Fill all required fields");
    return;
  }

  const payload = {
    action: "addAdvance",
    worker_name: worker,
    advance_type: type,
    amount: Number(amount),
    production_unit: unit
  };

  fetch(API_URL,{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify(payload)
  })
  .then(r=>r.json())
  .then(res=>{
    if(res.success){
      alert("Advance Saved ‚úî");
      closeAdvance();
    }else{
      alert("Failed ‚ùå");
    }
  })
  .catch(()=>alert("Network Error ‚ùå"));
}
</script>


</body>
</html>
